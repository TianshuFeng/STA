#' tp_data = chicken_generator(1)
#' tp_dist = dist(tp_data[,-1])
#' filter_eccen(dist = tp_dist, p = 2)
#'
filter_eccen = function(dist, p, ...) {
# p: exponent
dist = as.matrix(dist)
res = rowMeans(dist^p)^(1/p)
res = as.matrix(res)
attr(res, "filter") = "Eccentricity"
class(res) = "filter"
return(res)
}
#' Which filter function produces the filter?
#'
#' \code{filter_name} returns the name of the filter function that produces the
#' provided filter.
#'
#' @param filter_vec The filter vector.
#'
#' @return The name of the filter.
#' @export
#'
#' @examples
#' tp_data = chicken_generator(1)
#' tp_dist = dist(tp_data[,-1])
#' res = filter_eccen(dist = tp_dist, p = 2)
#' filter_name(res)
#' ## "Eccentricity"
filter_name = function(filter_vec) {
if(!("filter" %in% names(attributes(filter_vec)))) {
stop("Filter vector not from standard filter functions.")
}
return(attr(filter_vec, "filter"))
}
a = filter_eccen(dist = tp_dist, p = 2)
b = filter_coordinate(tp_data[,-1], 2)
c = filter_gaussian(dist=tp_dist, sigma=1)
as.numeric(a)
a
as.matrix(a)
as.data.frame(a)
attributes(a)$filter
class(a) = "numeric"
a
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, tp_filter)
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
return(res)
}
a = filter_eccen(dist = tp_dist, p = 2)
b = filter_coordinate(tp_data[,-1], 2)
c = filter_gaussian(dist=tp_dist, sigma=1)
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
return(res)
}
filter_list = list(a,b,c)
res = NULL
dat = tp_data
group_ind = tp_data$Group
num_intervals = 10
percent_overlap = 70
arg_mapper = list()
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon, tp_spread))
}
res
tp_filter
tp_shannon
tp_spread
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res)
res[,2:3] = as.numeric(res[,2:3])
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res)
res[,2:3] = lapply(res[,2:3], as.numeric)
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
a = filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
a[,2]
return(res)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res)
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res)
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
a = filter_eccen(dist = tp_dist, p = 2)
b = filter_coordinate(tp_data[,-1], 2)
c = filter_gaussian(dist=tp_dist, sigma=1)
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res)
res[,2:3] = lapply(res[,2:3], as.numeric)
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res)
#res[,2:3] = lapply(res[,2:3], as.numeric)
return(res)
}
res = filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
res
res[,2]
/as.data.frame
?as.data.frame
res[,2:3] = lapply(res[,2:3], as.numeric)
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res, stringsAsFactors = FALSE)
res[,2:3] = lapply(res[,2:3], as.numeric)
return(res)
}
filter_evaluate(a,b,c,
dat = tp_data, group_ind = tp_data$Group,
num_intervals = 10, percent_overlap = 70)
mean_dist
print.filter = function(x) {
cat("This is the filter vecter returned by", attributes(x)$filter, ".\n", sep = "")
}
print(a)
print.filter = function(x) {
cat("This is the filter vecter returned by ", attributes(x)$filter, ".\n", sep = "")
}
print(a)
print.filter = function(x) {
cat("This is the filter vecter returned by ",
attributes(x)$filter, " filter function.\n", sep = "")
}
print(a)
#'                 num_intervals = 10, percent_overlap = 70)
#'
#' # Add additional arguments (NOT RUN)
#' if(FALSE) {
#'   filter_evaluate(a,b,c,
#'                   dat = tp_data, group_ind = tp_data$Group,
#'                   num_intervals = 10, percent_overlap = 70,
#'                   arg_mapper = list(n_class = 1))
#' }
#'
filter_evaluate = function(..., dat, group_ind, num_intervals, percent_overlap,
arg_mapper = list()) {
filter_list = list(...)
res = NULL
arg_mapper$dat = dat
arg_mapper$group_ind = group_ind
arg_mapper$num_intervals = num_intervals
arg_mapper$percent_overlap = percent_overlap
for(ff in filter_list) {
tp_filter = attributes(ff)$filter
class(ff) = "numeric"
arg_mapper$filter_values = ff
tp_mapper = do.call(mapper.kmeans, arg_mapper)
tp_shannon = mapper_shannon_index(obj_mapper = tp_mapper, group_ind = group_ind)
tp_spread = spread_measure(obj_mapper = tp_mapper, group_ind = group_ind)
res = rbind(res, c(tp_filter, tp_shannon$avg_index, tp_spread))
}
colnames(res) = c("Filter", "weighted_shannon", "spread_index")
res = as.data.frame(res, stringsAsFactors = FALSE)
res[,2:3] = lapply(res[,2:3], as.numeric)
return(res)
}
attr(a, "filter")
devtools::document()
devtools::document()
require(visNetwork)
devtools::document()
?filter_evaluate
devtools::document()
?filter_evaluate
detach("package:TDAmapper", unload=TRUE)
network_visualization(tp_data_mapper, groups_ind = tp_data$Group, dat = tp_data[,2:4],folder = "Exp_network")
#'                       folder = "Exp_network")
#'
#' # Add additional analysis to nodes
#'
#' add_analysis_java = paste0('Node Index:<b>',
#'                            1:length(tp_data_mapper$points_in_vertex),
#'                            '</b><br>')
#' network_visualization(tp_data_mapper, groups_ind = tp_data$Group, dat = tp_data[,2:4],
#'                       folder = "Exp_network", add_analysis_java = add_analysis_java)
#'
network_visualization = function(obj_mapper, groups_ind, dat = NULL, folder = "",
add_surv_analysis = FALSE, add_analysis_java = NULL,
palette = "Set1", legend_ncol = 2,
color_code = NULL){
#  obj_mapper: the mapper object from TDAMapper
#  groups_ind: the vector of group each individual sample belongs to
require(visNetwork)
require(RColorBrewer)
if(class(obj_mapper) != "TDAmapper") {
stop("Invalid obj_mapper.")
}
if(is.null(color_code)){
color_code = auto_set_colorcode(groups = groups_ind,
palette = palette)
} else if(!check_color_code(color_code)){
stop("Invalid color code.")
}
dir.create(file.path(folder), showWarnings = FALSE)
obj_mapper = null_remover(obj_mapper)
MapperNodes <- mapperVertices(obj_mapper, 1)
MapperLinks <- mapperEdges(obj_mapper)
members = c()
for(i in obj_mapper$points_in_vertex){
members = c(members, paste0(i, collapse = ", "))
}
stats_sum = stat_summery(obj_mapper, groups_ind, dat = dat, folder = folder,
add_surv_analysis = add_surv_analysis,
add_analysis_java = add_analysis_java,
color_code = color_code)
nodes <- data.frame(id = 1:nrow(MapperNodes), #label = MapperNodes$Nodename,
value = MapperNodes$Nodesize,
group = stats_sum$dominant_group,
color = color_map(stats_sum$dominant_group,
color_code = color_code),
title = stats_sum$java_desp)
edges <- data.frame(from = MapperLinks$Linksource+1, to = MapperLinks$Linktarget+1)
visNetwork(nodes, edges, width = "100%", height = "700px") %>%
visInteraction(tooltipDelay = 500, selectConnectedEdges = FALSE,
tooltipStyle = 'position: fixed;visibility:hidden;padding: 5px;
white-space: normal;width: 150px;
font-family: cursive;font-size:12px;font-color:purple;background-color: #E6E6E6;
border-radius: 15px;') %>%
visOptions(selectedBy = "group",
highlightNearest = list(enabled =TRUE, degree = 2, hover = T)) %>%
visLegend(addNodes = legend_node(color_code = color_code),
useGroups = FALSE, enabled = TRUE,
width = 0.1, ncol = legend_ncol,
position = "left")  %>% sparkline::spk_add_deps()%>%
visSave(file = "network.html", background = "white")
file.rename(from = "network.html", to = file.path(folder, "network.html"))
}
detach("package:TDAmapper", unload=TRUE)
network_visualization(tp_data_mapper, groups_ind = tp_data$Group, dat = tp_data[,2:4],
folder = "Exp_network", add_analysis_java = add_analysis_java)
tp_data = chicken_generator(1)
tp_data_mapper = mapper.kmeans(dat = tp_data[,2:4],
filter_values = tp_data$Y,
num_intervals = 10,
percent_overlap = 70)
network_visualization(tp_data_mapper, groups_ind = tp_data$Group, dat = tp_data[,2:4],
folder = "Exp_network")
devtools::document()
devtools::document()
devtools::document()
?print.kmeans
print.kmeans
devtools::use_vignette("my-vignette")
install.packages("devtools")
install.packages('G:\My Drive\Mayo_intern files\Projects\Mapper_Visualization\Package\SemiMapper_0.3.tar.gz')
install.packages('G:/My Drive/Mayo_intern files/Projects/Mapper_Visualization/Package/SemiMapper_0.3.tar.gz')
install.packages('G:/My Drive/Mayo_intern files/Projects/Mapper_Visualization/Package/SemiMapper_0.3.tar.gz',repos = NULL, type="source")
install.packages("sparkline")
install.packages('G:/My Drive/Mayo_intern files/Projects/Mapper_Visualization/Package/SemiMapper_0.3.tar.gz',repos = NULL, type="source")
install.packages("formatR")
formatR::tidy_app()
formatR::tidy_app()
formatR::tidy_app()
devtools::check()
tp_data <- chicken_generator(1)
p_dist <- dist(tp_data[,-1])
tp_dist <- dist(tp_data[,-1])
filter_ref(dist=tp_dist, groups_ind=tp_data$Group, ref = "Shank")
diag(tp_dist)
rm(p_dist)
dim(tp_data)
dim(tp_dist)
class(tp_dist)
devtools::check()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
getwd()
?getwd
pkgdown::build_site()
pkgdown::build_site()
